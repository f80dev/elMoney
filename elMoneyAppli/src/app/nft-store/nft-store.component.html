<div class="mainform">
  <app-hourglass [message]="message"></app-hourglass>

  <div *ngIf="message.length==0">
    Vous avez {{user.gas/1e18 | number:'1.0-3'}} xEgld
    <br><br>
  </div>

  <div *ngIf="nfts.length==0 && message.length==0">
    Aucun token disponible pour l'instant
    &nbsp;<mat-icon style="font-size: small;" (click)="refresh()">refresh</mat-icon>
    <br><br>

    <button mat-raised-button
            mat-button class="app-button"
            (click)="router.navigate(['importer'])">
      Vendez le votre
    </button>

  </div>

  <div *ngIf="nfts.length>0">
    <mat-checkbox [(ngModel)]="perso_only" (click)="refresh(false)">Uniquement les miens</mat-checkbox>
    <br><br>

    <table *ngIf="message.length==0" class="mat-elevation-z4" style="margin-left:5%;width:90%;padding:5px;">
    <tr *ngFor="let nft of nfts" style="width: 100%;">
      <td style="text-align: left;width:60%;min-width: 200px;">
        <strong>{{nft.uri}}</strong><br>
        pour {{nft.price}} xEGld
        <br><br>
      </td>
      <td style="width: 20%;">
        <div *ngIf="nft.message?.length>0">
          <app-hourglass [message]="nft.message" fontsize="small"></app-hourglass>
        </div>
        <div *ngIf="nft.open?.length>0">
          <strong>{{nft.open}}</strong>
        </div>
      </td>
      <td style="text-align: right;width:100px;">
        <div *ngIf="nft.message?.length==0 && nft.open?.length==0">
          <button mat-icon-button
                  *ngIf="nft.owner!=user.addr"
                  class="icon-button"
                  (click)="buy(nft)">
            <mat-icon>shop</mat-icon>
          </button>
          <div *ngIf="nft.owner==user.addr">
            <button mat-icon-button mat-flat-button
                    *ngIf="nft.state==0"
                    class="icon-button"
                    (click)="setstate(nft,1,'retirer de la vente')">
              <mat-icon>cancel</mat-icon>
            </button>
            <button mat-icon-button mat-flat-button
                    *ngIf="nft.state==1 && nft.owner!=user.addr"
                    class="icon-button"
                    (click)="burn(nft)">
              <mat-icon>delete</mat-icon>
            </button>
            <button mat-icon-button
                    *ngIf="nft.state==1"
                    class="icon-button"
                    (click)="setstate(nft,1,'mise en vente')">
              <mat-icon>checkmark</mat-icon>
            </button>
            <button mat-icon-button
                    class="icon-button"
                    (click)="open(nft)">
              <mat-icon>unarchive</mat-icon>
            </button>
          </div>

        </div>

        <div *ngIf="nft.open?.length>0">
          <button mat-icon-button
                  class="icon-button"
                  (click)="nft.open=''">
            <mat-icon>visibility_off</mat-icon>
          </button>
        </div>

      </td>
    </tr>
  </table>
  </div>

</div>
