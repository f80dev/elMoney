 <div *ngIf="nfts?.length>0" style="margin: 8px;padding:8px;" class="wrap-list" >
    <mat-card class="app-card" style="width:300px;"
              *ngFor="let nft of nfts | filter: ['search',filter]">
      <mat-card-header>
        <img mat-card-avatar src="./assets/icons/gift.png" class="image-icon">
        <mat-card-title>
              {{nft.uri}}
          <span *ngIf="nft?.count && nft?.count>1">({{nft.count}})</span>
        </mat-card-title>
      </mat-card-header>
       <mat-card-content style="min-height: 50px;text-align: center;color: white;">

         <app-tuto [if]="nft.owner!=user.addr && nft.has_secret==1"
                   label="Devenez propriétaire de ce NFT pour accèder à son contenu."></app-tuto>

        <div *ngIf="nft.state!=0 && nft.owner!=user.addr">
          <img src="/assets/img/vendu.png" style="width:150px;">
        </div>

        <span *ngIf="nft.price>0 && nft.state==0 && (nft.owner==user.addr || nft.isDealer)">
          {{nft.price | number:'1.0-2'}} xEgld
        </span>

         <div *ngIf="nft.markup>0 && nft.state==0" style="font-size: small;text-align: left;">
           dont:
           <ul style="padding:0;margin:0;margin-left:20px;line-height: 90%;">
             <li *ngIf="nft?.miner_ratio>0">{{nft.markup*nft.miner_ratio/100 | number:'1.0-2'}} pour le createur</li>
             <li>{{nft.markup*(1-nft.miner_ratio/100) | number:'1.0-2'}} pour le distributeur</li>
           </ul>
         </div>

        <div *ngIf="nft.visual?.length>0">
          <img [src]="nft.visual" style="width:150px;">
        </div>


        <div *ngIf="nft.message?.length>0">
            <app-hourglass [message]="nft.message" fontsize="small"></app-hourglass>
          </div>

          <div *ngIf="nft.open?.length>0">
            <a *ngIf="nft.open.startsWith('http')" [href]="nft.open" target="_blank">Ouvrir le fichier</a>
            <span *ngIf="!nft.open.startsWith('http')"><strong>{{nft.open}}</strong></span>
          </div>

        <app-tuto [if]="nft.state==1"
                  label="Vous pouvez ouvrir les tokens que vous posséder pour voir ce qu'ils contiennent. Vous pouvez également les remettre en vente ou les détruire."></app-tuto>
      </mat-card-content>
      <mat-card-actions class="app-card-action">
          <div *ngIf="nft.message?.length==0 && nft.open?.length==0">
            <button mat-raised-button mat-button class="app-button"
                    *ngIf="nft.owner!=user.addr && nft.state==0 && !nft.isDealer"
                    [title]="'Acheter ce token pour '+nft.price+' xEgld'"
                    (click)="buy(nft)">
              <mat-icon>shopping_cart</mat-icon>&nbsp;
              <small *ngIf="nft.price==0">Gratuit</small>
              <span *ngIf="nft.price>0" style="font-size: large;">{{nft.price | number:'1.1-3'}} <small>xEGld</small></span>
            </button>

            <button mat-icon-button mat-flat-button
                      title="Modifier votre commission"
                      *ngIf="nft?.isDealer && nft.max_markup>nft.min_markup"
                      class="icon-button"
                      (click)="update_markup(nft)">
                <mat-icon>euro</mat-icon>
              </button>

            <div *ngIf="nft.owner==user.addr" style="display: inline-block">
              <button mat-raised-button mat-button
                      color="primary"
                      title="Ouvrir le token pour découvrir le secret"
                      *ngIf="nft.state==1 && user.add!=nft.miner && nft.has_secret==1"
                      class="app-button"
                      (click)="open(nft)">
               Ouvrir
              </button>



            <button mat-icon-button mat-flat-button
                      title="Ajouter un distributeur"
                      *ngIf="!nft?.isDealer"
                      class="icon-button"
                      (click)="add_dealer(nft)">
                <mat-icon>add_shopping_cart</mat-icon>
              </button>



              <button mat-icon-button mat-flat-button
                      *ngIf="nft.state==0 && (can_sell(nft.properties) || nft.miner==user.addr)"
                      title="Retirer de la vente"
                      class="icon-button"
                      (click)="setstate(nft,1,'retirer de la vente')">
                <mat-icon>remove_shopping_cart</mat-icon>
              </button>

               <button mat-icon-button mat-flat-button class="icon-button"
                      *ngIf="nft.state==1 && (can_sell(nft.properties) || nft.miner==user.addr)"
                       title="Mettre en vente"
                      (click)="setstate(nft,0,'mise en vente')">
                <mat-icon>shopping_cart</mat-icon>
              </button>

              <button mat-icon-button mat-flat-button class="icon-button"
                      title="Offrir ce token"
                      *ngIf="nft.state==1 && nft.owner==user.addr && (can_transfer(nft.properties) || nft.miner==user.addr)"
                      (click)="transfer(nft)">
                <mat-icon>redeem</mat-icon>
              </button>


              <button mat-icon-button mat-flat-button class="icon-button"
                      *ngIf="nft.state==1 && nft.owner==user.addr"
                      title="Détruire ce token"
                      (click)="burn(nft)">
                <mat-icon>delete</mat-icon>
              </button>
            </div>

            <button mat-button mat-raised-button
                      *ngIf="nft.state==0 && nft.owner==user.addr"
                      title="Faire la promotion de ce token"
                      class="app-button"
                      (click)="share(nft)">
                Promotion
              </button>

          </div>

          <div *ngIf="nft.open?.length>0">
            <button mat-icon-button
                    class="icon-button"
                    (click)="nft.open=''">
              <mat-icon>visibility_off</mat-icon>
            </button>
          </div>
      </mat-card-actions>
    </mat-card>
  </div>
